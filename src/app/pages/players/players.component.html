<div class="layout-wrapper">
  <!-- Oldalsáv: Hozzáadás + rendezés -->
  <div class="sidebar">
    <!-- Csak bejelentkezve jelenik meg a hozzáadás -->
    <ng-container *ngIf="user$ | async as user">
      <button mat-raised-button color="primary" (click)="openAddPlayerModal()">＋ Játékos hozzáadása</button>
    </ng-container>

    <div class="sort-buttons">
      <button mat-stroked-button (click)="sortPlayers('name', 'asc')">ABC ↑</button>
      <button mat-stroked-button (click)="sortPlayers('name', 'desc')">ABC ↓</button>
      <button mat-stroked-button (click)="sortPlayers('capNumber', 'asc')">Sapkaszám ↑</button>
      <button mat-stroked-button (click)="sortPlayers('capNumber', 'desc')">Sapkaszám ↓</button>
    </div>
  </div>

  <!-- Tartalom: Játékosok -->
  <div class="player-container">
    <ng-container *ngIf="sortedPlayers as players">
      <div *ngFor="let player of players" class="player-card" (click)="openPlayerModal(player)">
        <div class="player-header">
          <h3>
            {{ player.name }}
            <span class="cap-number">#{{ player.capNumber }}</span>
          </h3>
        </div>
        <img [src]="player.imageUrl" alt="{{ player.name }}" class="player-img" />
        <p class="info-link">Több információért kattints!</p>
      </div>
    </ng-container>
  </div>
</div>

<!-- PlayerDetailComponent modal -->
<app-player-detail
  [player]="selectedPlayer"
  [isOpen]="!!selectedPlayer"
  (close)="onPlayerDetailClose()"
  (edit)="onPlayerEdit($event)"
  (delete)="onPlayerDelete($event)">
</app-player-detail>

<!-- Hozzáadás modal -->
<div *ngIf="showAddPlayerForm" class="player-modal" (click)="closeAddPlayerModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <button class="close-btn" (click)="closeAddPlayerModal()">×</button>
    <h2>{{ isEditing ? 'Játékos módosítása' : 'Új játékos hozzáadása' }}</h2>

    <form [formGroup]="addPlayerForm" (ngSubmit)="isEditing ? submitUpdatePlayer() : submitNewPlayer()" class="add-player-form">
      <mat-form-field appearance="fill">
        <mat-label>Név</mat-label>
        <input matInput formControlName="name" required />
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Sapkaszám</mat-label>
        <input matInput type="number" formControlName="capNumber" required />
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Leírás</mat-label>
        <textarea matInput formControlName="bio"></textarea>
      </mat-form-field>

      <button mat-raised-button color="primary" type="submit" [disabled]="addPlayerForm.invalid">
        {{ isEditing ? 'Mentés' : 'Hozzáadás' }}
      </button>
    </form>
  </div>
</div>


